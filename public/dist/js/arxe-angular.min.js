var usersApp,locationsApp,wagesApp,timesheetsApp;Array.prototype.max=function(n){return this.filter(function(t,i){return i<n})};Array.prototype.offset=function(n){return this.filter(function(t,i){return i>n-1})};var use_pager=function(n){n.currentPage=1;n.pageSize=10;n.getPager=function(){for(var i=[],t=1;t<=Math.ceil(n.items.length/n.pageSize);t++)i.push(t);return i};n.getPage=function(t){var i=n.items.offset((t-1)*n.pageSize).max(n.pageSize);return console.log("Page "+t+" items",i),i};n.setPageNumber=function(t){n.currentPage=t};n.$watch("pageSize",function(t){t<1&&(n.pageSize=1)})},use_curd=function(n,t,i){n.items=[];n.clear=function(){n.model={}};n.save=function(r){t.post(i+"/upsert",r).then(function(t){t.data._id!=undefined&&(n.model=t.data,r._id==undefined?(n.items.push(n.model),$.toast({icon:"info",text:"item saved !"})):$.toast({icon:"info",text:"item updated !"}),n.clear())})};n.remove=function(r){console.log(r);swal({title:"Are you sure?",text:"You will not be able to recover .",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){t.post(i+"/remove",r).then(function(){n.items=_.filter(n.items,function(n){return n._id!=r._id});n.clear()})})};n.edit=function(t){n.model=t};t.get(i).then(function(t){n.items=t.data});n.clear()},projectsApp=angular.module("projects",[]);projectsApp.controller("main",function(n,t){use_pager(n);use_curd(n,t,"/api/projects")});usersApp=angular.module("users",[]);usersApp.controller("main",function(n,t){use_pager(n);use_curd(n,t,"/api/users")});locationsApp=angular.module("locations",[]);locationsApp.controller("main",function(n,t){use_pager(n);use_curd(n,t,"/api/locations")});wagesApp=angular.module("wages",[]);wagesApp.controller("main",function(n,t){use_pager(n);use_curd(n,t,"/api/wages")});wagesApp.filter("moment",function(){return function(n,t){return moment(n).format(t)}});timesheetsApp=angular.module("timesheets",[]);timesheetsApp.controller("main",function(n,t){use_pager(n);use_curd(n,t,"/api/timesheets")});